Table P1. Comparison of the Choice of PE for temporal tokens on Weather Dataset. The Lookback Length is $96$ and the Prediction Lengths $\in \{96, 192, 336, 720\}$.

| MSE/MAE | No PE       | Learnable PE | Learnable PE + GNEM | Sinusoidal PE | Sinusoidal PE + GNEM | Convolutional PE | Convolutional PE + GNEM |
| ------- | ----------- | ------------ | ------------------- | ------------- | -------------------- | ---------------- | ----------------------- |
|         |             |              |                     | **w/o SNEM**  |                      |                  |                         |
| 96      | 0.357/0.390 | 0.163/0.211  | 0.161/0.209         | 0.162/0.210   | 0.159/0.208          | 0.172/0.229      | 0.167/0.219             |
| 192     | 0.372/0.401 | 0.209/0.255  | 0.211/0.255         | 0.210/0.254   | 0.208/0.253          | 0.230/0.273      | 0.218/0.265             |
| 336     | 0.446/0.457 | 0.270/0.297  | 0.268/0.292         | 0.269/0.296   | 0.266/0.293          | 0.292/0.314      | 0.282/0.308             |
| 720     | 0.485/0.490 | 0.355/0.351  | 0.352/0.348         | 0.354/0.350   | 0.350/0.346          | 0.375/0.365      | 0.367/0.357             |
| Avg     | 0.415/0.435 | 0.249/0.279  | 0.248/0.276         | 0.249/0.278   | 0.246/0.275          | 0.267/0.295      | 0.259/0.287             |
|         |             |              |                     | **with SNEM** |                      |                  |                         |
| 96      | 0.351/0.387 | 0.161/0.210  | 0.159/0.207         | 0.161/0.208   | **0.156/0.206**      | 0.168/0.225      | 0.165/0.215             |
| 192     | 0.362/0.397 | 0.208/0.253  | 0.207/0.253         | 0.207/0.252   | **0.206/0.251**      | 0.224/0.268      | 0.214/0.261             |
| 336     | 0.441/0.455 | 0.268/0.295  | 0.265/0.294         | 0.266/0.296   | **0.264/0.291**      | 0.287/0.310      | 0.279/0.305             |
| 720     | 0.480/0.489 | 0.352/0.348  | 0.347/0.343         | 0.350/0.346   | **0.346/0.343**      | 0.370/0.358      | 0.366/0.354             |
| Avg     | 0.409/0.432 | 0.247/0.277  | 0.245/0.274         | 0.246/0.276   | **0.243/0.273**      | 0.262/0.290      | 0.256/0.284             |





Table P2. Comparison of the Choice of PE for temporal tokens on ECL Dataset. The Lookback Length is $96$ and the Prediction $\in \{96, 192, 336, 720\}$
| MSE/MAE | No PE       | Learnable PE | Learnable PE + GNEM | Sinusoidal PE | Sinusoidal PE + GNEM | Convolutional PE | Convolutional PE + GNEM |
| ------- | ----------- | ------------ | ------------------- | ------------- | -------------------- | ---------------- | ----------------------- |
|         |             |              |                     | **w/o SNEM**  |                      |                  |                         |
| 96      | 0.337/0.430 | 0.153/0.241  | 0.141/0.239         | 0.142/0.240   | 0.139/0.238          | 0.152/0.259      | 0.150/0.249             |
| 192     | 0.352/0.400 | 0.164/0.257  | 0.161/0.255         | 0.159/0.255   | 0.158/0.253          | 0.267/0.279      | 0.249/0.265             |
| 336     | 0.344/0.471 | 0.175/0.275  | 0.175/0.269         | 0.175/0.272   | 0.169/0.269          | 0.192/0.295      | 0.180/0.287             |
| 720     | 0.519/0.528 | 0.209/0.301  | 0.208/0.300         | 0.209/0.300   | 0.207/0.296          | 0.235/0.315      | 0.230/0.307             |
| Avg     | 0.388/0.457 | 0.175/0.269  | 0.171/0.266         | 0.171/0.267   | 0.168/0.264          | 0.211/0.287      | 0.202/0.277             |
|         |             |              |                     | **with SNEM** |                      |                  |                         |
| 96      | 0.332/0.427 | 0.141/0.238  | 0.138/0.236         | 0.139/0.237   | **0.136/0.233**      | 0.148/0.258      | 0.145/0.245             |
| 192     | 0.344/0.395 | 0.158/0.253  | 0.156/0.252         | 0.157/0.253   | **0.154/0.251**      | 0.264/0.278      | 0.248/0.263             |
| 336     | 0.341/0.464 | 0.172/0.272  | 0.170/0.268         | 0.171/0.269   | **0.168/0.266**      | 0.187/0.290      | 0.175/0.284             |
| 720     | 0.512/0.520 | 0.207/0.298  | 0.205/0.296         | 0.206/0.297   | **0.203/0.294**      | 0.231/0.312      | 0.228/0.307             |
| Avg     | 0.382/0.452 | 0.169/0.265  | 0.167/0.263         | 0.168/0.264   | **0.165/0.261**      | 0.207/0.285      | 0.199/0.275             |

Table P3. Comparison of the Choice of PE for temporal tokens on Traffic Dataset. The Lookback Length is $96$ and the Prediction $\in \{96, 192, 336, 720\}$
| MSE/MAE | No PE       | Learnable PE | Learnable PE + GNEM | Sinusoidal PE | Sinusoidal PE + GNEM | Convolutional PE | Convolutional PE + GNEM |
| ------- | ----------- | ------------ | ------------------- | ------------- | -------------------- | ---------------- | ----------------------- |
|         |             |              |                     | **w/o SNEM**  |                      |                  |                         |
| 96      | 0.533/0.417 | 0.393/0.268  | 0.388/0.264         | 0.391/0.265   | 0.386/0.271          | 0.152/0.259      | 0.150/0.249             |
| 192     | 0.578/0.414 | 0.408/0.282  | 0.404/0.280         | 0.405/0.282   | 0.402/0.277          | 0.267/0.279      | 0.249/0.265             |
| 336     | 0.643/0.449 | 0.428/0.294  | 0.421/0.289         | 0.426/0.293   | 0.420/0.287          | 0.192/0.295      | 0.180/0.287             |
| 720     | 0.714/0.535 | 0.265/0.308  | 0.462/0.304         | 0.464/0.305   | 0.459/0.303          | 0.235/0.315      | 0.230/0.307             |
| Avg     | 0.617/0.454 | 0.373/0.288  | 0.419/0.284         | 0.421/0.286   | 0.417/0.284          | 0.211/0.287      | 0.202/0.277             |
|         |             |              |                     | **with SNEM** |                      |                  |                         |
| 96      | 0.531/0.415 | 0.391/0.265  | 0.386/0.271         | 0.389/0.263   | **0.384/0.269**      | 0.410/0.298      | 0.404/0.295             |
| 192     | 0.575/0.412 | 0.405/0.281  | 0.402/0.278         | 0.403/0.280   | **0.399/0.275**      | 0.414/0.301      | 0.409/0.298             |
| 336     | 0.641/0.447 | 0.425/0.291  | 0.420/0.287         | 0.423/0.290   | **0.418/0.285**      | 0.427/0.320      | 0.425/0.317             |
| 720     | 0.712/0.531 | 0.262/0.305  | 0.459/0.302         | 0.460/0.304   | **0.456/0.299**      | 0.484/0.332      | 0.481/0.329             |
| Avg     | 0.615/0.451 | 0.371/0.285  | 0.417/0.285         | 0.419/0.284   | **0.414/0.282**      | 0.434/0.313      | 0.430/0.310             |



Table P4. Comparison of the Choice of PE for Variable Tokens on Weather Dataset. The Lookback Length is $96$ and the Prediction
Lengths $\in \{96, 192, 336, 720\}$.

| MSE/MAE | No PE       | Learnable PE | Learnable PE with GNEM | Sinusoidal PE | Sinusoidal PE with GNEM | Convolutional PE | Convolutional PE + GNEM |
| ------- | ----------- | ------------ | ---------------------- | ------------- | ----------------------- | ---------------- | ----------------------- |
|         |             |              |                        | **w/o SNEM**  |                         |                  |                         |
| 96      | 0.172/0.212 | 0.167/0.209  | 0.163/0.208            | 0.170/0.210   | 0.165/0.209             | 0.164/0.212      | 0.161/0.208             |
| 192     | 0.219/0.254 | 0.211/0.253  | 0.209/0.252            | 0.212/0.252   | 0.210/0.253             | 0.212/0.255      | 0.207/0.252             |
| 336     | 0.276/0.295 | 0.271/0.294  | 0.269/0.292            | 0.274/0.294   | 0.276/0.292             | 0.271/0.295      | 0.268/0.293             |
| 720     | 0.358/0.348 | 0.356/0.350  | 0.352/0.348            | 0.355/0.351   | 0.354/0.349             | 0.352/0.346      | 0.348/0.345             |
| Avg     | 0.256/0.277 | 0.251/0.277  | 0.248/0.275            | 0.253/0.277   | 0.251/0.276             | 0.250/0.277      | 0.246/0.275             |
|         |             |              |                        | **with SNEM** |                         |                  |                         |
| 96      | 0.172/0.212 | 0.165/0.208  | 0.161/0.207            | 0.168/0.211   | 0.162/0.207             | 0.159/0.206      | **0.156/0.206**         |
| 192     | 0.218/0.254 | 0.209/0.252  | 0.208/0.251            | 0.210/0.252   | 0.208/0.252             | 0.211/0.252      | **0.206/0.251**         |
| 336     | 0.274/0.296 | 0.269/0.296  | 0.267/0.292            | 0.270/0.293   | 0.268/0.291             | 0.266/0.292      | **0.264/0.291**         |
| 720     | 0.356/0.347 | 0.354/0.349  | 0.349/0.346            | 0.352/0.349   | 0.351/0.347             | 0.348/0.345      | **0.346/0.343**         |
| Avg     | 0.255/0.277 | 0.249/0.276  | 0.246/0.274            | 0.250/0.276   | 0.247/0.274             | 0.246/0.274      | **0.243/0.273**         |



Table P5. Comparison of the Choice of PE for Variable Tokens on ECL Dataset. The Lookback Length is $96$ and the Prediction
Lengths $\in \{96, 192, 336, 720\}$.

| MSE/MAE | No PE       | Learnable PE | Learnable PE with GNEM | Sinusoidal PE | Sinusoidal PE with GNEM | Convolutional PE | Convolutional PE + GNEM |
| ------- | ----------- | ------------ | ---------------------- | ------------- | ----------------------- | ---------------- | ----------------------- |
|         |             |              |                        | **w/o SNEM**  |                         |                  |                         |
| 96      | 0.153/0.242 | 0.148/0.242  | 0.142/0.239            | 0.150/0.241   | 0.144/0.238             | 0.142/0.238      | 0.138/0.234             |
| 192     | 0.167/0.270 | 0.163/0.260  | 0.159/0.257            | 0.162/0.263   | 0.158/0.258             | 0.161/0.257      | 0.156/0.253             |
| 336     | 0.182/0.279 | 0.175/0.254  | 0.172/0.273            | 0.176/0.274   | 0.174/0.274             | 0.172/0.270      | 0.170/0.267             |
| 720     | 0.216/0.301 | 0.209/0.304  | 0.208/0.300            | 0.214/0.304   | 0.212/0.301             | 0.207/0.299      | 0.205/0.296             |
| Avg     | 0.179/0.273 | 0.174/0.265  | 0.170/0.267            | 0.175/0.271   | 0.172/0.268             | 0.170/0.266      | 0.167/0.263             |
|         |             |              |                        | **with SNEM** |                         |                  |                         |
| 96      | 0.151/0.240 | 0.145/0.238  | 0.141/0.237            | 0.147/0.239   | 0.142/0.236             | 0.139/0.235      | **0.136/0.233**         |
| 192     | 0.165/0.268 | 0.159/0.258  | 0.157/0.254            | 0.160/0.261   | 0.157/0.255             | 0.159/0.254      | **0.154/0.251**         |
| 336     | 0.179/0.276 | 0.172/0.251  | 0.170/0.270            | 0.173/0.272   | 0.171/0.269             | 0.170/0.268      | **0.168/0.266**         |
| 720     | 0.213/0.297 | 0.207/0.301  | 0.205/0.297            | 0.210/0.300   | 0.208/0.298             | 0.205/0.296      | **0.203/0.294**         |
| Avg     | 0.177/0.270 | 0.171/0.262  | 0.168/0.268            | 0.172/0.268   | 0.169/0.265             | 0.168/0.263      | **0.165/0.261**         |


Table P6. Comparison of the Choice of PE for Variable Tokens on Traffic Dataset. The Lookback Length is $96$ and the Prediction
Lengths $\in \{96, 192, 336, 720\}$.

| MSE/MAE | No PE       | Learnable PE | Learnable PE with GNEM | Sinusoidal PE | Sinusoidal PE with GNEM | Convolutional PE | Convolutional PE + GNEM |
| ------- | ----------- | ------------ | ---------------------- | ------------- | ----------------------- | ---------------- | ----------------------- |
|         |             |              |                        | **w/o SNEM**  |                         |                  |                         |
| 96      | 0.394/0.276 | 0.389/0.273  | 0.389/0.273            | 0.390/0.276   | 0.389/0.273             | 0.394/0.274      | 0.387/0.272             |
| 192     | 0.407/0.282 | 0.408/0.275  | 0.409/0.278            | 0.405/0.278   | 0.408/0.279             | 0.412/0.479      | 0.402/0.278             |
| 336     | 0.428/0.295 | 0.428/0.287  | 0.430/0.285            | 0.324/0.276   | 0.429/0.285             | 0.429/0.285      | 0.421/0.287             |
| 720     | 0.465/0.309 | 0.468/0.312  | 0.467/0.306            | 0.465/0.309   | 0.465/0.307             | 0.463/0.306      | 0.458/0.301             |
| Avg     | 0.423/0.290 | 0.423/0.287  | 0.424/0.286            | 0.421/0.285   | 0.423/0.286             | 0.425/0.336      | 0.417/0.284             |
|         |             |              |                        | **with SNEM** |                         |                  |                         |
| 96      | 0.392/0.275 | 0.385/0.270  | 0.387/0.272            | 0.388/0.273   | 0.385/0.271             | 0.389/0.271      | **0.384/0.269**         |
| 192     | 0.405/0.279 | 0.407/0.272  | 0.408/0.275            | 0.402/0.276   | 0.405/0.274             | 0.407/0.275      | **0.399/0.275**         |
| 336     | 0.424/0.291 | 0.426/0.286  | 0.428/0.282            | 0.421/0.283   | 0.426/0.281             | 0.427/0.282      | **0.418/0.285**         |
| 720     | 0.460/0.308 | 0.465/0.309  | 0.464/0.302            | 0.462/0.306   | 0.461/0.304             | 0.459/0.303      | **0.456/0.299**         |
| Avg     | 0.420/0.288 | 0.421/0.284  | 0.422/0.283            | 0.418/0.285   | 0.419/0.283             | 0.421/0.283      | **0.414/0.282**         |